<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thrill x Scooby</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:ital,wght@1,800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0d1117; overflow-x: hidden; }
        .logo-font { font-family: 'Poppins', sans-serif; font-weight: 800; font-style: italic; letter-spacing: -0.05em; text-shadow: 0 0 8px rgba(34, 211, 238, 0.5), 0 0 20px rgba(34, 211, 238, 0.3); }
        .logo-x { font-size: 1.7em; line-height: 1; margin: 0 -0.1em; }
        #home-btn { cursor: pointer; transition: transform 0.3s ease; }
        body.leaderboard-active #home-btn:hover { transform: scale(1.03); }
        #home-btn:active { transform: scale(0.98); transition-duration: 0.1s; }
        .nav-button.active { background-color: #22d3ee; color: #0d1117; }
        .nav-button { transition: background-color 0.3s ease, color 0.3s ease; }
        .banner-container { width: 100%; background: radial-gradient(ellipse at center, rgba(14, 52, 68, 0.7) 0%, #0d1117 70%); padding: 2rem 0; position: relative; overflow: hidden; }
        .character { position: absolute; bottom: 0; width: 40%; max-width: 350px; opacity: 0.7; pointer-events: none; }
        .character.scooby { left: -5%; }
        .homepage-card { background-color: #161b22; border: 1px solid #30363d; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .homepage-card:hover { transform: translateY(-5px); box-shadow: 0 0 35px rgba(34, 211, 238, 0.6); }
        @keyframes stream { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        #wager-card { background: linear-gradient(90deg, transparent, rgba(255, 50, 50, 0.4), transparent), linear-gradient(90deg, #161b22, #111827); background-size: 200% 100%; animation: stream 5s ease-in-out infinite; border-color: #7f1d1d; }
        .leaderboard-table td { background-color: #0d1117; border-radius: 0.5rem; border: 1px solid #30363d; }
        .rank-badge { display: flex; align-items: center; justify-content: center; width: 2.2em; height: 2.2em; border-radius: 9999px; border: 2px solid #9ca3af; font-weight: 700; color: #22d3ee; margin-right: 1rem; flex-shrink: 0; }
        #degen-now-btn { animation: pulse-glow 2.5s ease-in-out infinite; border: 2px solid rgba(34, 211, 238, 0.5); }
        @keyframes pulse-glow { 0%, 100% { transform: scale(1); box-shadow: 0 0 15px rgba(34, 211, 238, 0.6); } 50% { transform: scale(1.05); box-shadow: 0 0 25px rgba(34, 211, 238, 1); } }
    </style>
</head>
<body class="text-gray-200 min-h-screen flex flex-col items-center">
    <div class="banner-container">
        <header id="main-header" class="text-center relative z-10">
            <h1 id="home-btn" class="logo-font text-5xl sm:text-6xl font-extrabold flex items-center justify-center">
                <span class="text-gray-200">Thrill</span><span class="logo-x text-[#22d3ee]">X</span><span class="text-gray-200">Scooby</span>
            </h1>
        </header>
    </div>

    <div class="w-full max-w-5xl mx-auto p-4 sm:p-6 md:p-8 mt-[-2rem] relative z-10">
        <main id="homepage">
             <div class="text-center mb-8"><p class="text-xl text-cyan-400 font-semibold tracking-wider">Code : SCOOBY</p></div>
             <div class="text-center mb-8">
                <a id="degen-now-btn" href="https://thrill.com/?r=Scooby" target="_blank" class="inline-block bg-green-500 text-white font-bold py-3 px-8 rounded-lg text-lg">Degen Time</a>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="wager-card" class="homepage-card rounded-xl p-8 text-center cursor-pointer flex flex-col">
                    <h2 class="text-2xl font-bold text-white">Bi-Weekly Wager</h2>
                    <p class="text-cyan-400 font-semibold">$5000 Prize Pool</p>
                </div>
            </div>
        </main>

        <div id="leaderboard-page" class="hidden">
            <nav class="flex justify-center bg-[#161b22] rounded-lg p-2 mb-8 shadow-lg">
                <button id="biweekly-btn" class="nav-button active py-2 px-6 rounded-md font-semibold w-1/2">Bi-Weekly</button>
                <button id="poker-btn" class="nav-button text-gray-300 py-2 px-6 rounded-md font-semibold w-1/2">Poker</button>
            </nav>
            <section id="biweekly-leaderboard" class="bg-[#161b22] rounded-xl p-6 border border-gray-700">
                <div class="text-center bg-[#0d1117] p-3 rounded-lg border border-gray-700 mb-4">
                    <span class="text-gray-400">Time Remaining: </span><span id="countdown" class="font-bold text-red-500 text-lg"></span>
                </div>
                <table class="w-full text-left"><tbody id="biweekly-body"></tbody></table>
            </section>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let allPlayersData = [];
            const homepage = document.getElementById('homepage');
            const leaderboardPage = document.getElementById('leaderboard-page');
            const homeBtn = document.getElementById('home-btn');
            const wagerCard = document.getElementById('wager-card');
            const biweeklyBody = document.getElementById('biweekly-body');
            const countdownElement = document.getElementById('countdown');

            // --- Navigation ---
            homeBtn.addEventListener('click', () => { homepage.classList.remove('hidden'); leaderboardPage.classList.add('hidden'); });
            wagerCard.addEventListener('click', () => { homepage.classList.add('hidden'); leaderboardPage.classList.remove('hidden'); });

            // --- Corrected Holiday Logic ---
            function getTargetDate() {
                const now = new Date();
                const year = now.getUTCFullYear();
                const month = now.getUTCMonth(); 
                const day = now.getUTCDate();

                if (month === 11 && day >= 28) {
                    return new Date(Date.UTC(year + 1, 0, 15, 0, 0, 0)); // Points to Jan 15
                } 
                if (month === 0 && day <= 14) {
                    return new Date(Date.UTC(year, 0, 15, 0, 0, 0)); // Jan 1-14 points to Jan 15
                }
                if (day >= 1 && day <= 14 && month !== 11) {
                    return new Date(Date.UTC(year, month, 15, 0, 0, 0)); // Normal Mid-Month
                } else {
                    return new Date(Date.UTC(year, month + 1, 1, 0, 0, 0)); // Normal Month-End
                }
            }

            // --- Data Fetching ---
            async function fetchAllData() {
                try {
                    const response = await fetch('/getLeaderboardData');
                    const data = await response.json();
                    if (data && Array.isArray(data.items)) {
                        biweeklyBody.innerHTML = data.items.map((p, i) => `<tr><td class="p-2 border-b border-gray-800"><span class="rank-badge">${i+1}</span> ${p.username}</td></tr>`).join('');
                    }
                } catch (e) {
                    biweeklyBody.innerHTML = '<tr><td class="text-red-500 p-4">Error: Could not load data.</td></tr>'; //
                }
            }

            // --- Countdown ---
            function updateCountdown() {
                const target = getTargetDate();
                const dist = target - new Date();
                if (dist < 0) { countdownElement.innerHTML = "Leaderboard Ended"; return; }
                const d = Math.floor(dist / 86400000);
                const h = Math.floor((dist % 86400000) / 3600000);
                const m = Math.floor((dist % 3600000) / 60000);
                const s = Math.floor((dist % 60000) / 1000);
                countdownElement.innerHTML = `${d}d ${h}h ${m}m ${s}s`;
            }

            setInterval(updateCountdown, 1000);
            fetchAllData();
            updateCountdown();
        });
    </script>
</body>
</html>
